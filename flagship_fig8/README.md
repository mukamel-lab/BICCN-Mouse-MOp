This folder contains scripts to regenerate the analysis in Fig8 a,c,e. ([BICCN MOp Flagship paper, 2020]())

Contact:
- Fangming Xie, f7xie@ucsd.edu
- Lab of Prof. Eran Mukamel, emukamel@ucsd.edu

---
The ```.ipynb``` notebooks contain code to regenerate the exact figure panels:
- ```fig8_a_c.ipynb```
- ```fig_e.ipynb```

The ```.py``` scripts contain utility functions used in the notebooks:
- ```__init__.py```
- ```utils.py```
- ```snmcseq_utils.py```

Integration results, including the analysis of this figure as pre-generated by [SingleCellFusion](https://github.com/mukamel-lab/SingleCellFusion) and analyses from the companion paperï¼ˆ[Yao et al. 2020](https://www.biorxiv.org/content/10.1101/2020.02.29.970558v2)), are located in the following folders:
- ```./ref```
- ```./results```

---
You can also regenerate the integration results from scratch by running [SingleCellFusion](https://github.com/mukamel-lab/SingleCellFusion) yourself using the configuration files in ```./scf_configs``` and with organized datasets (gene-by-cell matrices, metadata, etc.) here: 
- [Fig8a,c--11-dataset integration of MOp excitatory IT neurons](https://drive.google.com/file/d/1UrWQMIkwpU4NDEZL093lHAZgOfUwHdxo/view?usp=sharing) ([BICCN flagship paper]()) 
- [Fig8e--integration of mouse MOp and VISp excitatory neurons](https://drive.google.com/file/d/15Qf6JJJtD6FLV90JTzB3NoAPwf6WYynK/view?usp=sharing) ([Yao et al. 2020](https://www.biorxiv.org/content/10.1101/2020.02.29.970558v2) and [Tasic et al. 2018](https://www.nature.com/articles/s41586-018-0654-5))

Unzip the gzip files, place them in the current directory, and run ```SCF_main.py -c ./scf_configs/config_....py``` assuming SingleCellFusion is installed. Expect some minor changes to the embedding shapes because of random intial seeds.
 





